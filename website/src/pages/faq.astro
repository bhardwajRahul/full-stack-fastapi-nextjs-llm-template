---
import Layout from '../layouts/Layout.astro';
import Navbar from '../components/Navbar.astro';
import Footer from '../components/landing/Footer.astro';
import { translations, languages, defaultLang } from '../i18n/translations';
import { faqItems } from '../data/faq';

const lang = defaultLang;
const t = translations[lang];

const alternates = [
  { lang: "en", href: "/faq/" },
  ...Object.keys(languages)
    .filter((l) => l !== defaultLang)
    .map((l) => ({ lang: l, href: `/${l}/faq/` })),
];

const faqSchema = {
  "@context": "https://schema.org",
  "@type": "FAQPage",
  mainEntity: faqItems.map((item) => ({
    "@type": "Question",
    name: item.question[lang],
    acceptedAnswer: {
      "@type": "Answer",
      text: item.answer[lang],
    },
  })),
};
---

<Layout
  title={`${t["faq.title"]} â€” Vstorm OSS`}
  description={t["faq.subtitle"]}
  lang={lang}
  alternates={alternates}
>
  <Navbar currentLang={lang} />

  <script type="application/ld+json" set:html={JSON.stringify(faqSchema)} />

  <main class="mx-auto max-w-3xl px-4 py-16 sm:py-24">
    <div class="mb-12 text-center">
      <h1 class="text-3xl font-bold tracking-tight sm:text-4xl">{t["faq.title"]}</h1>
      <p class="mt-4 text-text-secondary">{t["faq.subtitle"]}</p>
    </div>

    <div class="space-y-3">
      {faqItems.map((item) => (
        <details class="group rounded-lg border border-border bg-surface transition-colors hover:border-border-hover">
          <summary class="flex cursor-pointer items-center justify-between px-6 py-4 font-medium select-none">
            <span>{item.question[lang]}</span>
            <svg
              class="h-5 w-5 shrink-0 text-text-tertiary transition-transform group-open:rotate-180"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              stroke-width="2"
            >
              <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
            </svg>
          </summary>
          <div class="px-6 pb-4 text-text-secondary leading-relaxed">
            {item.answer[lang]}
          </div>
        </details>
      ))}
    </div>
  </main>

  <Footer t={t} />
</Layout>
