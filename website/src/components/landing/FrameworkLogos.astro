---
import type { translations } from '../../i18n/translations';

interface Props {
  t: typeof translations.en;
}

const { t } = Astro.props;
const rawBase = import.meta.env.BASE_URL;
const base = rawBase.endsWith("/") ? rawBase : rawBase + "/";

const logos = [
  // AI Frameworks
  { name: "Pydantic AI", src: "pydantic.png", invert: false },
  { name: "LangChain", src: "langchain.png", invert: true },
  { name: "LangGraph", src: "langgraph.png", invert: true },
  { name: "CrewAI", src: "crewai.png", invert: false },
  { name: "DeepAgents", src: null, invert: false },
  // Core Stack
  { name: "FastAPI", src: "fastapi.png", invert: false },
  { name: "Next.js", src: "nextjs.png", invert: true },
  { name: "Python", src: "python.png", invert: false },
  { name: "TypeScript", src: "typescript.png", invert: false },
  // Databases
  { name: "PostgreSQL", src: "postgre.png", invert: true, big: true },
  { name: "MongoDB", src: "mongodb.png", invert: false },
  { name: "Redis", src: "redis.png", invert: false },
  // Infrastructure
  { name: "Docker", src: "docker.png", invert: false },
  { name: "Kubernetes", src: "kubernates.png", invert: false },
  { name: "Sentry", src: "sentry.png", invert: false, big: true },
  { name: "Prometheus", src: "prometheus.png", invert: false },
  // Bonus
  { name: "Logfire", src: "logfire.png", invert: false },
  { name: "Tailwind CSS", src: "tailwindcss.png", invert: false },
];
---

<section class="reveal px-4 py-16 sm:px-6 sm:py-20 lg:px-8">
  <div class="mx-auto max-w-5xl text-center">
    <p class="text-xs font-medium uppercase tracking-[0.2em] text-text-tertiary">{t["frameworks.title"]}</p>

    <!-- Marquee wrapper with fade edges -->
    <div class="marquee-wrapper mt-10 relative overflow-hidden">
      <!-- Fade overlays -->
      <div class="pointer-events-none absolute inset-y-0 left-0 z-10 w-16 sm:w-24 bg-gradient-to-r from-bg to-transparent"></div>
      <div class="pointer-events-none absolute inset-y-0 right-0 z-10 w-16 sm:w-24 bg-gradient-to-l from-bg to-transparent"></div>

      <!-- Scrolling track (duplicated for seamless loop) -->
      <div class="marquee-track flex w-max items-center gap-12 sm:gap-16">
        {[...logos, ...logos].map((logo) => (
          <div class="flex-shrink-0 flex items-center justify-center h-12" title={logo.name}>
            {logo.src ? (
              <img
                src={`${base}logos/${logo.src}`}
                alt={logo.name}
                class={`logo-img object-contain ${
                  logo.invert ? "logo-invert" : ""
                } ${
                  logo.invert || logo.big
                    ? "h-10 sm:h-14 max-w-[130px] sm:max-w-[160px]"
                    : "h-8 sm:h-10 max-w-[100px] sm:max-w-[120px]"
                }`}
                loading="lazy"
              />
            ) : (
              <span class="text-xs font-semibold text-text-tertiary whitespace-nowrap">{logo.name}</span>
            )}
          </div>
        ))}
      </div>
    </div>
  </div>
</section>

<style>
  /* Marquee animation */
  @keyframes marquee {
    0% { transform: translateX(0); }
    100% { transform: translateX(-50%); }
  }

  .marquee-track {
    animation: marquee 40s linear infinite;
  }

  .marquee-wrapper:hover .marquee-track {
    animation-play-state: paused;
  }

  /* Default: colorful logos, slightly dimmed */
  .logo-img {
    opacity: 0.7;
    transition: opacity 0.2s, filter 0.2s;
  }
  .logo-img:hover {
    opacity: 1;
  }

  /* Dark mode: invert only logos marked with .logo-invert (LangChain, LangGraph, Next.js) */
  html:not([data-theme="light"]) .logo-invert {
    filter: brightness(0) invert(1);
  }
  html:not([data-theme="light"]) .logo-invert:hover {
    filter: brightness(0) invert(1);
    opacity: 1;
  }
</style>
